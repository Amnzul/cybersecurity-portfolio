<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Suricata Notes</title>
  <link rel="stylesheet" href="../../styles.css"/>
  <style>
    /* Override: Remove canvas/matrix rain for this page */
    #matrix-rain { display: none !important; }
    body {
      background: #000 !important;
    }
  </style>
</head>
<body>
  <header>
    <h1>Mr. W. - Suricata</h1>
    <nav>
      <a href="../../index.html">Portfolio Home</a>
    </nav>
  </header>

<section id="suricata">

<h2>Suricata IDS Notes</h2>

<p></p>

<h2>Rules:</h2>

<pre ><code>Rules consists of three components: an action, a header, and rule options.
Suricata processes rules in a default order: pass, drop, reject, and alert. Rule order affects the final verdict of a packet.
The header defines the signature’s network traffic, which includes protocols, IP addresses, ports, and traffic direction.</code></pre>

<h2>Log locations:</h2>

<pre><code>/var/log/suricata/fast.log are Suricata basic alerts (depreciated)
/var/log/suricata/eve.json Suricata default event log</code></pre>

<h2>Variables:</h2>

<pre><code>$HOME_NET is a Suricata variable defined in /etc/suricata/suricata.yaml that you can use in your rule definitions as a placeholder for your local or home network to identify traffic that connects to or from systems within your organization.</code></pre>
<p></p>

<h2>Example:</h2>

<pre><code>Example:
custom.rules file:
alert http $HOME_NET any -&gt; $EXTERNAL_NET any (msg:"GET on wire"; flow:established,to_server; content:"GET"; http_method; sid:12345; rev:3;)

The msg: option provides the alert text. In this case, the alert will print out the text “GET on wire”, which specifies why the alert was triggered.
The flow:established,to_server option determines that packets from the client to the server should be matched. (In this instance, a server is defined as the device responding to the initial SYN packet with a SYN-ACK packet.)
The content:"GET" option tells Suricata to look for the word GET in the content of the http.method portion of the packet.
The sid:12345 (signature ID) option is a unique numerical value that identifies the rule.
The rev:3 option indicates the signature's revision which is used to identify the signature's version. Here, the revision version is 3.
</code></pre>

<hr>

<pre><code>sudo suricata -r sample.pcap -S custom.rules -k none
    The -r sample.pcap option specifies an input file to mimic network traffic. In this case, the sample.pcap file.
    The -S custom.rules option instructs Suricata to use the rules defined in the custom.rules file.
    The -k none option instructs Suricata to disable all checksum checks.
</code></pre>

<hr>

<pre><code>

jq . /var/log/suricata/eve.json | less (easier to read json files)
jq -c "[.timestamp,.flow_id,.alert.signature,.proto,.dest_ip]" /var/log/suricata/eve.json (extracts the fields specified in the list in the square brackets from the JSON payload.)
jq "select(.flow_id==X)" /var/log/suricata/eve.json (Replace X with any of the flow_id values returned by the previous query)
</code></pre>

<p>Network flow refers to a sequence of packets between a source and destination that share common characteristics such as IP addresses, protocols, and more. Suricata assigns a unique flow_id to each network flow. All logs from a network flow share the same flow_id. This makes the flow_id field a useful field for correlating network traffic that belongs to the same network flows.</p>


<p></p>



<p>Thats all for now!</p>
 

<p></p>
<p></p>
<p></p>
    
</section>
<footer>
<p>&copy; 2025 Mr. W. All rights reserved.</p>
<div class="footer">
<a href="https://amnzul.github.io/cybersecurity-portfolio/">Home</a>
</div>
</footer>
</body>
</html>
