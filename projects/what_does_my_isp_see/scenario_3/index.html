<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Project: What does my ISP see? Analyzing Packets. Scenario 3: Brave </title>
  <link rel="stylesheet" href="../../../styles.css"/>
  <style>
    /* Override: Remove canvas/matrix rain for this page */
    #matrix-rain { display: none !important; }
    body {
      background: #000 !important;
    }
  </style>
</head>
<body>
  <header>
    <h1>Mr. W. - Project: What does my ISP see? Analyzing Packets. Scenario 3: Brave</h1>
    <nav>
      <a href="../../../index.html">Portfolio Home</a>
    </nav>
  </header>

<section id="analyzing_packets">

<h2> Project: What does my ISP see? Analyzing Packets. Scenario 3: Brave</h2>

<p></p>

<h2>Scenario 3: Brave’s Tor Feature Breakdown:</h2>
<p></p>
<h2>Overview</h2>
<p></p>
<p>Brave has a built in feature to open a tab in Tor mode. Tor should be anonymous but does opening a new tab in the brave browser fulfill this expectation?</p>
<p></p>
<h2>Setup</h2>
<p>I set up a new virtual machine with Linux Ubuntu installed and Firefox for the first scenario. I am continuing to use the same operating system. I have now installed Brave too.</p>
<p>I will again look to capture packets from the same Ubuntu host that is browsing to see what exits the local host, from the Linux Mint hypervisor host, and finally on the OPNSense firewall between my router and the ISP ONT to see what exits my home network. I will also examine the Zenarmor NexGen Firewall Plugin live logs to watch for DNS resolution requests and connections.</p>
<p>I expect to see connections to Tor servers when I look at the traffic, but nothing beyond that.</p>
<p></p>
<p></p>
<hr>
<h2>Activity on the local host:</h2>
<p>The website used will be <a href="https://en.wikipedia.org/wiki/Brave_(web_browser)">https://en.wikipedia.org/wiki/Brave_(web_browser)</a>.  I set all devices to capture traffic, then load the webpage.</p>

<div style="text-align: center;">
<img src="scenario3bravetorurl.png" style="width: 50%; display: block; margin: 0 auto;">
</div>
  

<p></p>
<p>I capture all traffic using tcpdump and write it out to a file.</p>
<pre><code>sudo tcpdump -w scenario3bravetorubuntu.pcap</code></pre>
<p></p>
<p>Reading the packet capture file and filtering for port 53 shows all the DNS queries. Wikipedia is not in the list of requests so this must happen through the Tor connection. Listed here is the request to resolve safebrowsing.brave.com so this must be handling it.</p>

<img src="scenario3bravetorubuntutcpdumpport53.png">

<p>Reading the packet capture file again and filtering for port 80 shows no HTTP traffic. Likewise there were no visible ‘GET’ commands and wikipedia did not appear anywhere in the packet capture. Even the domain name is hidden when using Brave’s Tor tab.</p>

<img src="scenario3bravetorubuntutcpdumpport80.png">

<p></p>
<p></p>
<p></p>
<hr>
<h2>Activity seen on the VM’s Host using a Wireshark capture:</h2>
<p>The computer running the virtual machine is a Linux Mint PC, and it is also running Wireshark set to capture the same traffic for comparison.</p>
<p>Wireshark is filtering out port 53 to view DNS queries. Some DNS requests show the brave.com domain, but wikipedia is not present here.</p>

<img src="scenario3bravetorminthypervisorwiresharkport53.png">

<p>I apply a filter in Wireshark for wikipedia but nothing is seen.</p>

<img src="scenario3bravetorminthypervisorwiresharkfilterwikipedia.png">

<p>Wireshark is now filtering for brave domains. This is similar to what was seen in tcpdump but shows a few additional brave.com servers.</p>

<img src="scenario3bravetorminthypervisorwiresharkfilterbrave.png">

<p></p>
<p>DNS requests, and domain names were able to be seen in the traffic but complete website URLs, HTML content, etc, was not.</p>
<p></p>
<hr>
<h2>On the firewall beyond the router:</h2>
<p>Inspecting the firewall’s live logs showed nothing related to wikipedia.</p>
<p></p>

<img src="scenario3bravetorOPNzenarmor.png">

<p></p>
<p>I loaded the packet capture from this firewall into Wireshark for further analysis.</p>
<p>Wireshark is filtering out port 53 to view DNS queries. Seen in here is the DNS request for safebrowsing.brave.com but no mention of wikipedia or Tor.</p>

<img src="scenario3bravetorOPNwiresharkport53.png">

<p>Wireshark is filtering for wikipedia reveals nothing.</p>

<img src="scenario3bravetorOPNwiresharkfilterwikipedia.png">

<p>Wireshark filtering for Brave shows encrypted traffic but nothing is able to be made out.</p>

<img src="scenario3bravetorOPNwiresharkfilterbrave.png">

<p></p>
<p></p>
<p>This is the last hop where I can capture packets. This is the same data that is being seen outside my home network. </p>
<p></p>
<p></p>
<hr>
<h2>Conclusion:</h2>
<p>I was not able to detect what any of the traffic was using Brave’s Tor tab and only saw requests to the safebrowsing.brave.com servers. </p>
<p>Tor is meant to be private, anonymous and in this case it lived up to its reputation. It also has the downside of being slow, but if you don’t trust the coffee shop you are connected through, or live in a country that free speech is threatened, than this seems to improve the security of data in transit.</p>

  
  
<p>That’s it!</p>
<p></p>
<p></p>
<p></p>
    
</section>
<footer>
<p>&copy; 2025 Mr. W. All rights reserved.</p>
<div class="footer">
<a href="https://amnzul.github.io/cybersecurity-portfolio/">Home</a>
</div>
</footer>
</body>
</html>
