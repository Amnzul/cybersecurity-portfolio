<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Project: What does my ISP see? Analyzing Packets. Scenario 4: HTTPS + DoH </title>
  <link rel="stylesheet" href="../../../styles.css"/>
  <style>
    /* Override: Remove canvas/matrix rain for this page */
    #matrix-rain { display: none !important; }
    body {
      background: #000 !important;
    }
  </style>
</head>
<body>
  <header>
    <h1>Mr. W. - Project: What does my ISP see? Analyzing Packets. Scenario 4: HTTPS + DoH.</h1>
    <nav>
      <a href="../../../index.html">Portfolio Home</a>
    </nav>
  </header>

<section id="analyzing_packets">

<h2> Project: What does my ISP see? Analyzing Packets. Scenario 4: HTTPS + DoH.</h2>
<p></p>

<h2>Scenario 4: HTTPS + DoH. Breakdown:</h2>
<p></p>
<h2>Overview</h2>
<p></p>
<p>DoH is DNS over HTTPS. DoH encrypts DNS queries by sending them over HTTPS, enhancing privacy and security by preventing eavesdropping and manipulation of DNS data.</p>
<p>DoH will encrypt your DNS requests so lets see what that looks like, and what is able to be seen from a packet capture.</p>
<p></p>
<h2>Setup</h2>
<p>I set up a new virtual machine with Linux Ubuntu installed and Firefox in previous scenarios. I am continuing to use the same operating system.</p>
<p>This time I have made some changes to the Firefox settings to require DoH.</p>
<p>Here I have enabled HTTPS-Only Mode.</p>

<figure class="wp-block-image size-large"><img data-attachment-id="469" data-permalink="https://mrwlabs.wordpress.com/project-what-does-my-isp-see-analyzing-packets-scenario-4/firefoxhttpsonly/" data-orig-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/firefoxhttpsonly.png" data-orig-size="1028,476" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="firefoxhttpsonly" data-image-description="" data-image-caption="" data-medium-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/firefoxhttpsonly.png?w=300" data-large-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/firefoxhttpsonly.png?w=1024" width="1024" height="474" src="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/firefoxhttpsonly.png?w=1024" alt="" class="wp-image-469" srcset="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/firefoxhttpsonly.png?w=1024 1024w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/firefoxhttpsonly.png?w=150 150w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/firefoxhttpsonly.png?w=300 300w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/firefoxhttpsonly.png?w=768 768w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/firefoxhttpsonly.png 1028w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>

<p>Here DNS over HTTPS is set to always use secure DNS.</p>

<figure class="wp-block-image size-large"><img data-attachment-id="470" data-permalink="https://mrwlabs.wordpress.com/project-what-does-my-isp-see-analyzing-packets-scenario-4/firefoxdohonly/" data-orig-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/firefoxdohonly.png" data-orig-size="662,745" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="firefoxdohonly" data-image-description="" data-image-caption="" data-medium-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/firefoxdohonly.png?w=267" data-large-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/firefoxdohonly.png?w=662" width="662" height="745" src="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/firefoxdohonly.png?w=662" alt="" class="wp-image-470" srcset="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/firefoxdohonly.png 662w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/firefoxdohonly.png?w=133 133w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/firefoxdohonly.png?w=267 267w" sizes="(max-width: 662px) 100vw, 662px"></figure>

<p>I will again look to capture packets from the same Ubuntu host that is browsing to see what exits the local host, and again on the OPNSense firewall between my router and the ISP ONT to see what exits my home network. I will also examine the Zenarmor NexGen Firewall Plugin live logs to watch for connections being made and traffic.</p>
<p>I hope to see only encrypted traffic in this scenario.</p>
<p></p>
<p></p>
<hr>
<h2>Activity on the local host:</h2>
<p>The website used will be <a href="https://duckduckgo.com/">https://duckduckgo.com/</a>. I set all devices to capture traffic, then load the webpage.</p>

<figure class="wp-block-image size-medium"><img data-attachment-id="475" data-permalink="https://mrwlabs.wordpress.com/project-what-does-my-isp-see-analyzing-packets-scenario-4/scenario4httpsdohurl/" data-orig-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohurl.png" data-orig-size="1279,707" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="scenario4httpsdohurl" data-image-description="" data-image-caption="" data-medium-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohurl.png?w=300" data-large-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohurl.png?w=1024" width="300" height="165" src="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohurl.png?w=300" alt="" class="wp-image-475" srcset="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohurl.png?w=298 298w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohurl.png?w=597 597w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohurl.png?w=150 150w" sizes="(max-width: 300px) 100vw, 300px"></figure>

<p></p>
<p>I capture all traffic using tcpdump and write it out to a file.</p>
<pre><code>sudo tcpdump -w scenario4httpsdohubuntu.pcap</code></pre>
<p></p>
<p>Reading the packet capture file and filtering for port 53 shows all the DNS queries. Duckduckgo is not in the list of requests so this must be encrypted and not able to be deciphered. Cloudflare DNS is shown here which is the provider selected in the Firefox DNS over HTTPS settings.</p>

<figure class="wp-block-image size-large"><img data-attachment-id="477" data-permalink="https://mrwlabs.wordpress.com/project-what-does-my-isp-see-analyzing-packets-scenario-4/scenario4httpsdohubuntutcpdumpport53/" data-orig-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpport53.png" data-orig-size="1216,432" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="scenario4httpsdohubuntutcpdumpport53" data-image-description="" data-image-caption="" data-medium-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpport53.png?w=300" data-large-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpport53.png?w=1024" loading="lazy" width="1024" height="363" src="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpport53.png?w=1024" alt="" class="wp-image-477" srcset="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpport53.png?w=1022 1022w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpport53.png?w=150 150w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpport53.png?w=300 300w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpport53.png?w=768 768w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpport53.png 1216w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>

<p>There were no visible ‘GET’ commands and Duckduckgo did not appear anywhere in the packet capture. Even the domain name is hidden when using DoH.</p>

<figure class="wp-block-image size-large"><img data-attachment-id="478" data-permalink="https://mrwlabs.wordpress.com/project-what-does-my-isp-see-analyzing-packets-scenario-4/scenario4httpsdohubuntutcpdumpcloudflare/" data-orig-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpcloudflare.png" data-orig-size="1213,321" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="scenario4httpsdohubuntutcpdumpcloudflare" data-image-description="" data-image-caption="" data-medium-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpcloudflare.png?w=300" data-large-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpcloudflare.png?w=1024" loading="lazy" width="1024" height="270" src="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpcloudflare.png?w=1024" alt="" class="wp-image-478" srcset="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpcloudflare.png?w=1024 1024w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpcloudflare.png?w=1020 1020w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpcloudflare.png?w=150 150w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpcloudflare.png?w=300 300w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpcloudflare.png?w=768 768w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpcloudflare.png 1213w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>

<p>Traffic must still flow from the duckduckgo server though. So resolving the <a href="http://www.duckduckgo.com" rel="nofollow">http://www.duckduckgo.com</a> address using the dig command shows the IP address.</p>

<figure class="wp-block-image size-large"><img data-attachment-id="479" data-permalink="https://mrwlabs.wordpress.com/project-what-does-my-isp-see-analyzing-packets-scenario-4/scenario4httpsdohdigduckduckgo/" data-orig-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohdigduckduckgo.png" data-orig-size="1213,570" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="scenario4httpsdohdigduckduckgo" data-image-description="" data-image-caption="" data-medium-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohdigduckduckgo.png?w=300" data-large-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohdigduckduckgo.png?w=1024" loading="lazy" width="1024" height="481" src="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohdigduckduckgo.png?w=1024" alt="" class="wp-image-479" srcset="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohdigduckduckgo.png?w=1024 1024w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohdigduckduckgo.png?w=150 150w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohdigduckduckgo.png?w=300 300w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohdigduckduckgo.png?w=768 768w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohdigduckduckgo.png 1213w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>

<p>Armed with this information we can see there was indeed traffic from Duckduckgo’s IP address to the computer.</p>
<pre><code>tcpdump -r scenario4httpsdohubuntu.pcap host 52.149.246.39</code></pre>

<figure class="wp-block-image size-large"><img data-attachment-id="482" data-permalink="https://mrwlabs.wordpress.com/project-what-does-my-isp-see-analyzing-packets-scenario-4/scenario4httpsdohubuntutcpdumpduckduckgoiptraffic-2/" data-orig-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpduckduckgoiptraffic-1.png" data-orig-size="1210,492" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="scenario4httpsdohubuntutcpdumpduckduckgoiptraffic" data-image-description="" data-image-caption="" data-medium-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpduckduckgoiptraffic-1.png?w=300" data-large-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpduckduckgoiptraffic-1.png?w=1024" loading="lazy" width="1024" height="416" src="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpduckduckgoiptraffic-1.png?w=1024" alt="" class="wp-image-482" srcset="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpduckduckgoiptraffic-1.png?w=1024 1024w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpduckduckgoiptraffic-1.png?w=150 150w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpduckduckgoiptraffic-1.png?w=300 300w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpduckduckgoiptraffic-1.png?w=768 768w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohubuntutcpdumpduckduckgoiptraffic-1.png 1210w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>

<p>This required a few more steps, but an ISP would still be able to see where traffic is coming from even though the DNS requests are encrypted. Unencrypted DNS queries just make it easy for eavesdroppers.</p>

<p></p>
<hr>
<h2>On the firewall beyond the router:</h2>
<p>Inspecting the firewall’s live logs showed no DNS requests for Duckduckgo. This makes sense since they are encrypted.</p>

<figure class="wp-block-image size-large"><img data-attachment-id="485" data-permalink="https://mrwlabs.wordpress.com/project-what-does-my-isp-see-analyzing-packets-scenario-4/scenario4httpsdohopnzenarmordnsduckduckgo/" data-orig-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmordnsduckduckgo.png" data-orig-size="2497,587" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="scenario4httpsdohOPNzenarmordnsduckduckgo" data-image-description="" data-image-caption="" data-medium-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmordnsduckduckgo.png?w=300" data-large-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmordnsduckduckgo.png?w=1024" loading="lazy" width="1024" height="240" src="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmordnsduckduckgo.png?w=1024" alt="" class="wp-image-485" srcset="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmordnsduckduckgo.png?w=1024 1024w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmordnsduckduckgo.png?w=1021 1021w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmordnsduckduckgo.png?w=2042 2042w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmordnsduckduckgo.png?w=150 150w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmordnsduckduckgo.png?w=300 300w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmordnsduckduckgo.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>

<p>The firewall did see the same cloudflare DNS traffic as the Ubuntu workstation.</p>

<figure class="wp-block-image size-large"><img data-attachment-id="486" data-permalink="https://mrwlabs.wordpress.com/project-what-does-my-isp-see-analyzing-packets-scenario-4/scenario4httpsdohopnzenarmordnscloudflare/" data-orig-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmordnscloudflare.png" data-orig-size="2492,515" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="scenario4httpsdohOPNzenarmordnscloudflare" data-image-description="" data-image-caption="" data-medium-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmordnscloudflare.png?w=300" data-large-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmordnscloudflare.png?w=1024" loading="lazy" width="1024" height="211" src="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmordnscloudflare.png?w=1024" alt="" class="wp-image-486" srcset="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmordnscloudflare.png?w=1024 1024w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmordnscloudflare.png?w=1021 1021w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmordnscloudflare.png?w=2042 2042w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmordnscloudflare.png?w=150 150w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmordnscloudflare.png?w=300 300w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmordnscloudflare.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>

<p>In the TLS tab of the live logs the firewall does show traffic to Duckduckgo. </p>

<figure class="wp-block-image size-large"><img data-attachment-id="489" data-permalink="https://mrwlabs.wordpress.com/project-what-does-my-isp-see-analyzing-packets-scenario-4/scenario4httpsdohopnzenarmortls/" data-orig-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmortls.png" data-orig-size="2500,792" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="scenario4httpsdohOPNzenarmortls" data-image-description="" data-image-caption="" data-medium-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmortls.png?w=300" data-large-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmortls.png?w=1024" loading="lazy" width="1024" height="324" src="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmortls.png?w=1024" alt="" class="wp-image-489" srcset="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmortls.png?w=1024 1024w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmortls.png?w=2045 2045w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmortls.png?w=150 150w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmortls.png?w=300 300w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnzenarmortls.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>

<p>I am assuming the firewall is doing automatic lookups to the IP address to show this information.</p>
<p></p>
<p>I loaded the packet capture from this firewall into Wireshark for further analysis.</p>
<p>Wireshark is filtering out port 53 to view DNS queries. Seen in here is the DNS request for cloudflare but no mention of Duckduckgo itself.</p>

<figure class="wp-block-image size-large"><img data-attachment-id="492" data-permalink="https://mrwlabs.wordpress.com/project-what-does-my-isp-see-analyzing-packets-scenario-4/scenario4httpsdohopnwiresharkdns/" data-orig-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkdns.png" data-orig-size="1228,507" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="scenario4httpsdohOPNwiresharkdns" data-image-description="" data-image-caption="" data-medium-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkdns.png?w=300" data-large-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkdns.png?w=1024" loading="lazy" width="1024" height="422" src="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkdns.png?w=1024" alt="" class="wp-image-492" srcset="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkdns.png?w=1022 1022w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkdns.png?w=150 150w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkdns.png?w=300 300w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkdns.png?w=768 768w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkdns.png 1228w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>

<p>Wireshark filtering for Duckduckgo only gives us encrypted traffic.</p>

<figure class="wp-block-image size-large"><img data-attachment-id="493" data-permalink="https://mrwlabs.wordpress.com/project-what-does-my-isp-see-analyzing-packets-scenario-4/scenario4httpsdohopnwiresharkfilterduckduckgo/" data-orig-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkfilterduckduckgo.png" data-orig-size="1236,838" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="scenario4httpsdohOPNwiresharkfilterduckduckgo" data-image-description="" data-image-caption="" data-medium-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkfilterduckduckgo.png?w=300" data-large-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkfilterduckduckgo.png?w=1024" loading="lazy" width="1024" height="694" src="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkfilterduckduckgo.png?w=1024" alt="" class="wp-image-493" srcset="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkfilterduckduckgo.png?w=1024 1024w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkfilterduckduckgo.png?w=150 150w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkfilterduckduckgo.png?w=300 300w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkfilterduckduckgo.png?w=768 768w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkfilterduckduckgo.png 1236w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>

<p>Wireshark filtering for the Duckduckgo IP address we found previous shows encrypted traffic but nothing is able to be made out in terms of content.</p>

<figure class="wp-block-image size-large"><img data-attachment-id="495" data-permalink="https://mrwlabs.wordpress.com/project-what-does-my-isp-see-analyzing-packets-scenario-4/scenario4httpsdohopnwiresharkfilterduckduckgoip/" data-orig-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkfilterduckduckgoip.png" data-orig-size="1235,839" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="scenario4httpsdohOPNwiresharkfilterduckduckgoip" data-image-description="" data-image-caption="" data-medium-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkfilterduckduckgoip.png?w=300" data-large-file="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkfilterduckduckgoip.png?w=1024" loading="lazy" width="1024" height="695" src="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkfilterduckduckgoip.png?w=1024" alt="" class="wp-image-495" srcset="https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkfilterduckduckgoip.png?w=1024 1024w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkfilterduckduckgoip.png?w=150 150w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkfilterduckduckgoip.png?w=300 300w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkfilterduckduckgoip.png?w=768 768w, https://mrwlabs.wordpress.com/wp-content/uploads/2025/06/scenario4httpsdohopnwiresharkfilterduckduckgoip.png 1235w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>

<p></p>
<p></p>
<p>This is the last hop where I can capture packets. This is the same data that is being seen outside my home network. </p>
<p></p>
<p></p>
<hr>
<h2>Conclusion:</h2>
<p>Webpage content is hidden, as are the requests to resolve a web server into its IP address.</p>
<p>DoH encrypts the DNS queries, but your computer still is communicating with the IP address of a remote server, which can be looked up.</p>
<p>Encrypting DNS queries is gaining momentum and becoming the norm in our world of ever increased risk and security.</p>
<p>Anyone intercepting traffic can still see source and destination IP addresses.</p>
<p>This is the equivalent of sending an encoded letter through the mail. If someone opens your letter they cant read it, but the postman still needs to know where to deliver the mail.</p>

  
  
<p>That’s it!</p>
<p></p>
<p></p>
<p></p>
    
</section>

</body>
</html>
